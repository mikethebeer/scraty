<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Scraty Frontpage</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/w3.css" type="text/css" media="all">
    <link rel="stylesheet" href="../../bower_components/jquery-ui/themes/base/jquery-ui.min.css" type="text/css" media="all">
    <link href="../../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../bower_components/mjolnic-bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css" rel="stylesheet">
    <script type="text/javascript" src="../../bower_components/requirejs/require.js" data-main="app/requireConfig" ></script>

    <script type="text/html" id="tasks-tmpl">
        <div data-bind="hover: id">
            <div class="w3-card-8 w3-light-grey task" data-bind="attr: { id: id }, drag: {value: $data}">
                <header class="w3-blue" align="center">
                    <span data-bind="text: user"></span>
                </header>
                <span data-bind="html: markdownText"></span>
                <div class="actions">
                    <button type="button" class="btn btn-info btn-xs" aria-label="Left Align">
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true" data-bind="click: open"></span>
                    </button>
                    <button type="button" class="btn btn-danger btn-xs" aria-label="Left Align">
                        <span class="glyphicon glyphicon-remove" aria-hidden="true" data-bind="click: removeTask"></span>
                    </button>
                </div>
            </div>
        </div>
    </script>
  </head>

  <body>
      <div class="logo">
          <img src="img/scraty-logo.png" width="150px"/>
      </div>
      <div>
          <button id="btn-users" class="btn btn-info btn-xs">Users</button>
      </div>
      <div id="user-dialog">
          <div class="form-group" data-bind="foreach: users">
              <div class="input-group input-group-sm">
                  <span class="input-group-addon" id="sizing-addon1">@</span>
                  <input type="text" data-bind="textInput: name" class="form-control" placeholder="Username" aria-describedby="sizing-addon1">
                  <input class="form-control color-picker" type="text" data-bind="textInput: color">
              </div>
              <button class="btn btn-success" data-bind="click: saveUser">Save</button>
            </div>
      </div>
      <div class="table-responsive">
          <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th class="stories"><h5>Stories</h5></th>
                    <th><h5>Todo</h5></th>
                    <th><h5>In Progress</h5></th>
                    <th><h5>Verify</h5></th>
                    <th><h5>Done</h5></th>
                </tr>
            </thead>
            <tbody data-bind="foreach: stories">
                <tr>
                    <td>
                        <h4 data-bind="html: markdownText"></h4>
                        <button class="btn btn-info btn-xs" data-bind="click: open">Edit</button>
                        <button id="remove_story" class="btn btn-danger btn-xs" data-bind="click: $root.removeStory">Remove</button>
                        <button id="add_task" class="btn btn-primary btn-xs pull-right" data-bind="click: addTask">Add task</button>

                        <div data-bind="foreach: tasks">
                            <div class="dialog" data-bind="dialog: {autoOpen: false, title: 'Edit task' }, dialogVisible: isOpen">
                                <div class="form-group">
                                  <textarea data-bind="textInput: text" class="form-control" rows="4"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-addon" id="sizing-addon1">@</span>
                                        <input type="text" data-bind="textInput: user" class="form-control" placeholder="Username" aria-describedby="sizing-addon1">
                                    </div>
                                </div>
                                <button class="btn btn-success" data-bind="click: saveTask">Save</button>
                            </div>
                        </div>
                    </td>
                    <td data-bind="template: { name: 'tasks-tmpl', foreach: todoTasks }, attr: { state: 0 }, drop: {value: $data}" class="state"> </td>
                    <td data-bind="template: { name: 'tasks-tmpl', foreach: inProgressTasks }, attr: { state: 1 }, drop: {value: $data}" class="state"></td>
                    <td data-bind="template: { name: 'tasks-tmpl', foreach: verifyTasks }, attr: { state: 2 }, drop: {value: $data}" class="state"></td>
                    <td data-bind="template: { name: 'tasks-tmpl', foreach: doneTasks }, attr: { state: 3 }, drop: {value: $data}" class="state"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <button id="add_story" class="btn btn-success" type="submit" data-bind="click: addStoryDialog">Add Story</button>
    <div data-bind="foreach: stories">
        <div class="dialog" data-bind="dialog: {autoOpen: false, title: 'Edit story' }, dialogVisible: isOpen">
            <div class="form-group">
                <textarea data-bind="textInput: text" class="form-control" rows="4"></textarea>
            </div>
            <button class="btn btn-success" data-bind="click: saveStory($parent)">Save</button>
        </div>
    </div>
  </body>
</html>
